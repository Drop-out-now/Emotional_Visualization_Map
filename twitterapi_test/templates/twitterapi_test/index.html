<!DOCTYPE html>
<html lang="ja">

<head>
<meta charset="UTF-8">
<title>Sample_GoogleMap</title>
<!-- <script src="http://maps.google.com/maps/api/js?key={{ googlemap_key }}&language=ja"></script> -->
<script src="http://code.jquery.com/jquery-3.6.0.min.js"></script>


<style>
html { height: 100% }
body { height: 100% }
#map { height: 100%; width: 100%}
</style>
</head>

<body>
<div id="map"></div>

<script>
  $(function() {
    var POLLING_INTERVAL_TIME_IN_MILLIS = 1000; // 実行インターバル（ミリ秒）
    
    (function polling() {
        AutoReload();
        window.setTimeout(polling, POLLING_INTERVAL_TIME_IN_MILLIS);
    }());

    function AutoReload() {
      /////////////////////////
      // このようにviews.pyで取得したデータをdateに代入したいが、views.pyの実行は起動時のみなので変化しない
      /////////////////////////
      
      {% autoescape off %}
      var array_lola = {{ array_lola }};
      {% endautoescape %}

      var date = new Date();
  
      $.ajax({
          type : "GET",
          // data: {
          //     "now_date": date,
          // },
          contentType: "application/json",
          // timeout: 5000,
      }).done(function(data) {
          $('#map').text(array_lola);
      }).fail(function(jqXHR, textStatus) {
          $('#map').text('fail');
      });
    }
  });
</script>
</body>
</html>