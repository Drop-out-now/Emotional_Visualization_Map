<!DOCTYPE html>
<html lang="ja">

<head>
<meta charset="UTF-8">
<title>Sample_GoogleMap</title>
<script src="http://maps.google.com/maps/api/js?key={{ googlemap_key }}&language=ja"></script>


<!-- Bootstrap CSS Ë™≠„ÅøËæº„Åø -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
<style>
html { height: 100% }
body { height: 100% }
#map { height: 100%; width: 100%}
.tablesorter th{
    position: relative;
    cursor: pointer;
    text-align: left;
}
.tablesorter th::before, .tablesorter th::after{
    content: '';
    position: absolute;
    z-index: 2;
    right: 7px;
    width: 0;
    height: 0;
    border: 4px dashed;
    border-color: #333 transparent;
    pointer-events: none;
}
.tablesorter th::before{
    border-bottom-style: solid;
    border-top: none;
    top: 30%;
}
.tablesorter th::after{
    border-top-style: solid;
    border-bottom: none;
    bottom: 30%;
}
.tablesorter th.tablesorter-headerAsc:after{
    border: none;
}
.tablesorter th.tablesorter-headerAsc:before{
    top: 50%;
    transform: translateY(-50%);
    -webkit-transform: translateY(-50%);
}
.tablesorter th.tablesorter-headerDesc:before{
    border: none;
}
.tablesorter th.tablesorter-headerDesc:after{
    top: 50%;
    transform: translateY(-50%);
    -webkit-transform: translateY(-50%);
}
.tablesorter th.sorter-false:before, .tablesorter th.sorter-false:after{
    border: none;
}
</style>

</head>

<body>

  <nav class="navbar navbar-expand-sm sticky-top navbar-dark bg-dark mt-3 mb-3">
      <!-- nav„Çø„Ç∞„ÅØ‰∏ä„ÅÆ„É°„Éã„É•„Éº„Éê„Éº„Å´„Å§„ÅÑ„Å¶„ÅÆË®≠ÂÆö -->
    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„ÅÆÂàáÊõø">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="#">Emotional_Visualization_Map</a>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" href="/../.">„Éö„Éº„Ç∏Âàá„ÇäÊõø„Åà</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/../../static_pages/home">„Ç¢„Éó„É™„Å´„Å§„ÅÑ„Å¶</a>
        </li>
      </ul>
    </div>
  </nav>
  <progress value="35" max="100"></progress>
<div id="map"></div>
</body>

<script>

var Array_lola = {{array_lola | safe}};
var MyLatLng = new google.maps.LatLng(35.6811673, 139.7670516);

var Options = {
 zoom: 5,      //Âú∞Âõ≥„ÅÆÁ∏ÆÂ∞∫ÂÄ§
 center: MyLatLng,    //Âú∞Âõ≥„ÅÆ‰∏≠ÂøÉÂ∫ßÊ®ô
 mapTypeId: 'roadmap'   //Âú∞Âõ≥„ÅÆÁ®ÆÈ°û
};
var map = new google.maps.Map(document.getElementById('map'), Options);

       //map„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„Å®„Åç„ÅÆ„Ç§„Éô„É≥„Éà„ÇíË®≠ÂÆö


function circle(LatLng,emotion){
  if(emotion>0){
    switch (emotion){
       case 1:
       var cityCircle = new google.maps.Circle({
           strokeOpacity: 0.8,
           strokeWeight: 2,
           fillOpacity: 0.60,
           map,
           center: LatLng,
           radius: 70000,
           fillColor: "#FF5347",
           strokeColor: "#FF0000",
       });
        break;
       case 2:
       var cityCircle = new google.maps.Circle({
           strokeOpacity: 0.8,
           strokeWeight: 2,
           fillOpacity: 0.60,
           map,
           center: LatLng,
           radius: 70000,
           fillColor: "#FF4500",
           strokeColor: "#FF0000",
       });
        break;
       case 3:
       var cityCircle = new google.maps.Circle({
           strokeOpacity: 0.8,
           strokeWeight: 2,
           fillOpacity: 0.60,
           map,
           center: LatLng,
           radius: 70000,
           fillColor: "#FF0000",
           strokeColor: "#FF0000",
       });
        break;
       default:
    }

    new google.maps.Marker({
        position: LatLng,
        map,
        icon: {
          url: '',
          size: new google.maps.Size(1, 1)
        },
        label: {
          text: "üòä",
          color: '#ffff00',
          fontFamily: 'sans-serif',
          fontWeight: 'bold',
          fontSize: '20px'
        }
        });
  }else {
    switch (emotion){
  case -1:
  var cityCircle = new google.maps.Circle({
      strokeOpacity: 0.8,
      strokeWeight: 2,
      fillOpacity: 0.60,
      map,
      center: LatLng,
      radius: 70000,
      fillColor: "#00bfff",
      strokeColor: "##007BC3",
  });
    break;
  case -2:
  var cityCircle = new google.maps.Circle({
      strokeOpacity: 0.8,
      strokeWeight: 2,
      fillOpacity: 0.60,
      map,
      center: LatLng,
      radius: 70000,
      fillColor: "#0000ff",
      strokeColor: "#007BC3",
  });
    break;
  case -3:
  var cityCircle = new google.maps.Circle({
      strokeOpacity: 0.8,
      strokeWeight: 2,
      fillOpacity: 0.60,
      map,
      center: LatLng,
      radius: 70000,
      fillColor: "#000080",
      strokeColor: "#007BC3",
  });
    break;
  default:
}

    var cityCircle = new google.maps.Circle({
        strokeOpacity:0.8,
        strokeWeight: 2,
        fillOpacity: 0.35,
        map,
        center: LatLng,
        radius: 70000,
        fillColor: "#007BC3",
        strokeColor: "#007BC3",
    });
    new google.maps.Marker({
        position: LatLng,
        map,
        icon: {
          url: '',
          size: new google.maps.Size(1, 1)
        },
        label: {
          text: 'üò¢',
          color: '#ffff00',
          fontFamily: 'emojione mozilla',
          fontWeight: 'bold',
          fontSize: '20px'
        }
        });
  }

  cityCircle.addListener('mouseover', mylistener);


  function mylistener(event){
      //marker‰ΩúÊàê

      var coposition = new google.maps.LatLng(event.latLng.lat(), event.latLng.lng());
      var comment = LatLngkikaku(event.latLng.lat(), event.latLng.lng());

      var infoWindow = new google.maps.InfoWindow({ // Âêπ„ÅçÂá∫„Åó„ÅÆËøΩÂä†
               content: '<div class="sample">'+comment[0]+'</div></br><div class="sample">'+comment[1]+'</div></br><div class="sample">'+comment[2]+'</div></br><div class="sample">'+comment[3]+'</div></br><div class="sample">'+comment[4]+'</div></br>', // Âêπ„ÅçÂá∫„Åó„Å´Ë°®Á§∫„Åô„ÇãÂÜÖÂÆπ
               position : coposition,
      })
      infoWindow.open(map);
      cityCircle.addListener('mouseout', function() { // „Éû„Éº„Ç´„Éº„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„Å®„Åç
          infoWindow.close(map); // Âêπ„ÅçÂá∫„Åó„ÅÆË°®Á§∫
      });
  }

}


function LatLngkikaku(makerlo,makerla){
  var length = 10000000;
  var o,a,emo;
  var Array_tweets;
  for(var i=0; i<12; i++){
    var lo = Array_lola[i][0];
    var la = Array_lola[i][1];
    var r = (lo-makerlo)*(lo-makerlo)+(la-makerla)*(la-makerla);
    if(length>r){
      length = r;
      Array_tweets = Array_lola[i][4];
    }
  }
  return Array_tweets;
}

console.log(LatLngkikaku(35.6811673, 139.7670516));

console.log(Array_lola);

for (var i=0; i<12; i++){
  var lo = Array_lola[i][0];
  var la = Array_lola[i][1];
  var emotion_plus = Array_lola[i][2];
  var emotion_minus = Array_lola[i][3];
  var LatLng = new google.maps.LatLng(lo,la);
  console.log(LatLng);
  var emotion =emotion_plus*emotion_minus;

  var plusf = Math.ceil(3*emotion_plus);
  var minusf = Math.floor(3*emotion_minus);
  var emotionf = minusf+plusf;
  console.log(emotion_plus);
  console.log(emotion_minus);

  console.log(plusf);
  console.log(minusf);
  console.log(emotionf);

  circle(LatLng,emotionf);

}

</script>
<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.0/js/jquery.tablesorter.min.js"></script>

</html>
